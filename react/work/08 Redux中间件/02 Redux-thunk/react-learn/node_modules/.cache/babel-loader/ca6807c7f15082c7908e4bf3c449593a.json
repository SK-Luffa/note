{"ast":null,"code":"import compose from \"./compose\";\n/**\n * 注册中间件\n * @param  {...any} middlewares 所有的中间件\n */\nexport default function () {\n  for (var _len = arguments.length, middlewares = new Array(_len), _key = 0; _key < _len; _key++) {\n    middlewares[_key] = arguments[_key];\n  }\n  return function (createStore) {\n    //给我创建仓库的函数\n    //下面的函数用于创建仓库\n    return function (reducer, defaultState) {\n      //创建仓库\n      const store = createStore(reducer, defaultState);\n      let dispatch = () => {\n        throw new Error(\"目前还不能使用dispatch\");\n      };\n      const simpleStore = {\n        getState: store.getState,\n        dispatch: store.dispatch\n      };\n      //给dispatch赋值\n      //根据中间件数组，得到一个dispatch创建函数的数组\n      const dispatchProducers = middlewares.map(mid => mid(simpleStore));\n      dispatch = compose(...dispatchProducers)(store.dispatch);\n      return {\n        ...store,\n        dispatch\n      };\n    };\n  };\n}","map":{"version":3,"names":["compose","middlewares","createStore","reducer","defaultState","store","dispatch","Error","simpleStore","getState","dispatchProducers","map","mid"],"sources":["/Users/dengzixu/Documents/notes/react/work/08 Redux中间件/02 Redux-thunk/react-learn/src/redux/applyMiddleware.js"],"sourcesContent":["import compose from \"./compose\"\n/**\n * 注册中间件\n * @param  {...any} middlewares 所有的中间件\n */\nexport default function (...middlewares) {\n    return function (createStore) { //给我创建仓库的函数\n        //下面的函数用于创建仓库\n        return function (reducer, defaultState) {\n            //创建仓库\n            const store = createStore(reducer, defaultState);\n            let dispatch = () => { throw new Error(\"目前还不能使用dispatch\") };\n            const simpleStore = {\n                getState: store.getState,\n                dispatch: store.dispatch\n            }\n            //给dispatch赋值\n            //根据中间件数组，得到一个dispatch创建函数的数组\n            const dispatchProducers = middlewares.map(mid => mid(simpleStore));\n            dispatch = compose(...dispatchProducers)(store.dispatch);\n            return {\n                ...store,\n                dispatch\n            }\n        }\n    }\n}"],"mappings":"AAAA,OAAOA,OAAO,MAAM,WAAW;AAC/B;AACA;AACA;AACA;AACA,eAAe,YAA0B;EAAA,kCAAbC,WAAW;IAAXA,WAAW;EAAA;EACnC,OAAO,UAAUC,WAAW,EAAE;IAAE;IAC5B;IACA,OAAO,UAAUC,OAAO,EAAEC,YAAY,EAAE;MACpC;MACA,MAAMC,KAAK,GAAGH,WAAW,CAACC,OAAO,EAAEC,YAAY,CAAC;MAChD,IAAIE,QAAQ,GAAG,MAAM;QAAE,MAAM,IAAIC,KAAK,CAAC,iBAAiB,CAAC;MAAC,CAAC;MAC3D,MAAMC,WAAW,GAAG;QAChBC,QAAQ,EAAEJ,KAAK,CAACI,QAAQ;QACxBH,QAAQ,EAAED,KAAK,CAACC;MACpB,CAAC;MACD;MACA;MACA,MAAMI,iBAAiB,GAAGT,WAAW,CAACU,GAAG,CAACC,GAAG,IAAIA,GAAG,CAACJ,WAAW,CAAC,CAAC;MAClEF,QAAQ,GAAGN,OAAO,CAAC,GAAGU,iBAAiB,CAAC,CAACL,KAAK,CAACC,QAAQ,CAAC;MACxD,OAAO;QACH,GAAGD,KAAK;QACRC;MACJ,CAAC;IACL,CAAC;EACL,CAAC;AACL"},"metadata":{},"sourceType":"module"}